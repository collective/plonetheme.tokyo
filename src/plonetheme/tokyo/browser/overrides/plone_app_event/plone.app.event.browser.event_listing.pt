<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="plonetheme.siguv">

<body>
  <metal:main fill-slot="main">

    <tal:def tal:define="header view/header_string; mode request/mode|string:future">

      <header>
        <h1 tal:content="context/title">Title</h1>
        <p class="lead" tal:content="context/description">Lorem ipsum dolor sit amet</p>
      </header>

      <h2 tal:content="header/sub" tal:condition="header/sub" />

      <tal:def tal:define="show_filter view/show_filter">

        <tal:cond tal:condition="show_filter">

          <tal:cond tal:condition="python:mode=='past'">
            <a class="btn btn-primary mr-2" href="" tal:attributes="href view/mode_future_url" i18n:translate="mode_future_link">Upcoming Events</a>
          </tal:cond>

          <tal:cond tal:condition="python:mode=='future'">
            <a class="btn btn-primary mr-2" href="" tal:attributes="href view/mode_past_url" i18n:translate="mode_past_link">Past Events</a>
          </tal:cond>

        </tal:cond>

        <a class="btn btn-primary"
           href=""
           tal:attributes="href view/ical_url"
           title="Download this event in iCal format"
           i18n:attributes="title title_add_to_ical"
           i18n:translate="label_add_to_ical">
          Download as iCal
        </a>

      </tal:def>

    </tal:def>

    <div class="pt-3 pb-3">
      <tal:def tal:define="batch view/events; toLocalizedTime nocall:context/@@plone/toLocalizedTime">

        <section>
          <tal:repeat repeat="data batch">
            <article itemscope itemtype="http://data-vocabulary.org/Event"
                     tal:define="startf python:view.date_speller(data.start)">

              <ul class="d-none">
                <li itemprop="startDate" tal:content="data/start/isoformat"></li>
                <li itemprop="endDate" tal:content="data/end/isoformat"></li>
              </ul>

              <div class="card mb-3">
                <div class="card-body">
                  <div class="card-title mb-2">
                    <a href="" itemprop="url" tal:attributes="href data/url">
                      <span itemprop="summary" tal:content="data/title"></span>
                    </a>
                  </div>
                  <div class="card-subtitle mb-2 text-muted" tal:content="structure python:view.formatted_date(data)"></div>
                  <p class="card-text" itemprop="description" tal:condition="data/description" tal:content="data/description" />
                </div>
              </div>

            </article>
          </tal:repeat>
        </section>

        <div metal:use-macro="context/batch_macros/macros/navigation" />

      </tal:def>
    </div>

  </metal:main>
</body>

</html>
